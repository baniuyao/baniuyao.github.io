<!doctype html>
<html class="theme-next use-motion ">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />








  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>



  <link href='//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'>


<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.5.1"/>




  <meta name="keywords" content="Hexo,next" />



  <link rel="alternate" href="/atom.xml" title="Renjie Yao's Blog" type="application/atom+xml" />



  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.1" />


<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Renjie Yao's Blog">
<meta property="og:url" content="http://blog.yaorenjie.com/index.html">
<meta property="og:site_name" content="Renjie Yao's Blog">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Renjie Yao's Blog">
<meta name="twitter:description">


<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: '',
    sidebar: 'post'
  };
</script>

  <title> Renjie Yao's Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  

  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?14c861085b24e8d70ed28c14d40e7cbc";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand" rel="start">
      <span class="logo">
        <i class="icon-next-logo"></i>
      </span>
      <span class="site-title">Renjie Yao's Blog</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon icon-next-home"></i> <br />
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            <i class="menu-item-icon icon-next-archives"></i> <br />
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            <i class="menu-item-icon icon-next-tags"></i> <br />
            Tags
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content"> 
  <section id="posts" class="posts-expand">
    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/12/01/The-Comparsion-Between-Apache-Flume-and-Heka/" itemprop="url">
                The Comparsion Between Apache Flume and Heka
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on
          <time itemprop="dateCreated" datetime="2016-12-01T17:45:32+08:00" content="2016-12-01">
            2016-12-01
          </time>
        </span>

        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2016/12/01/The-Comparsion-Between-Apache-Flume-and-Heka/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/12/01/The-Comparsion-Between-Apache-Flume-and-Heka/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h1 id="Environment">Environment</h1><p>This test’s main purpose is to choose the tool used to collect log on servers. In this test, we use Apache Flume and Heka to collect raw log data and send them into Kafka. The Kafka is in all default configuration. Linux is CentOS 6.4 with 12 cores CPU, 45GB memory and JDK 1.7.</p>
<h2 id="Benchmark_Metrics">Benchmark Metrics</h2><ol>
<li>mps - Message Per Second: This data is fetched from JMX port of Kafka. We get the total message count from Kafka, and then get this count again. The delta value is the message count in 1 second - mps. We can get mps by command line:</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar /tmp/cmdline-jmxclient-0.10.3.jar - localhost:9999 kafk&#13;a.server:name=MessagesInPerSec,type=BrokerTopicMetrics Count</span><br></pre></td></tr></table></figure>
<ol>
<li>channelSize (only for Flume): This metrics is the number of messages Flume cannot handle in a while. It can be a measurement to determin if the Flume is health. A health Flume instance should keep this value in a low number. We can get this value by Flume http service:</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -s localhost:34545/metrics | python -m json.tool | grep Channe&#13;lSize</span><br></pre></td></tr></table></figure>
<ol>
<li>%cpu and %mem: We get these two values directly by linux <code>top</code> command:</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flume_pid=`jps -m | grep App | cut -d&#39; &#39; -f1`&#13;flume_cpu=`top -b -n1 -p $flume_pid | grep $flume_pid | awk &#39;&#123;print&#13;$9&#125;&#39;`&#13;flume_mem=`top -b -n1 -p $flume_pid | grep $flume_pid | awk &#39;&#123;print&#13;$10&#125;&#39;`</span><br></pre></td></tr></table></figure>
<h2 id="Benchmark_Items">Benchmark Items</h2><p>We used a tool to write log lines into log files with different mps - 5K, 10K, 50K.</p>
<h1 id="Flume_Benchmarks">Flume Benchmarks</h1><h2 id="Flume_Configuration">Flume Configuration</h2><p><strong>JVM</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JAVA_OPTS=&#34;-Xms256m -Xmx256m -Dflume.monitoring.type=http -Dflume.monitoring.port=34545&#34;</span><br></pre></td></tr></table></figure>
<p><strong>Flume Configuration</strong></p>
<pre><code>agent<span class="class">.sources</span> = fileSource
agent<span class="class">.channels</span> = diskChannel memChannel
agent<span class="class">.sinks</span> = kafkaSink

agent<span class="class">.sources</span><span class="class">.fileSource</span><span class="class">.type</span> = exec
agent<span class="class">.sources</span><span class="class">.fileSource</span><span class="class">.command</span> = tail -F /tmp/example<span class="class">.log</span>
agent<span class="class">.sources</span><span class="class">.fileSource</span><span class="class">.channels</span> = memChannel

agent<span class="class">.channels</span><span class="class">.memChannel</span><span class="class">.type</span> = memory
agent<span class="class">.channels</span><span class="class">.memChannel</span><span class="class">.capacity</span> = <span class="number">1000000</span>
agent<span class="class">.channels</span><span class="class">.memChannel</span><span class="class">.transactionCapacity</span> = <span class="number">10000</span>

agent<span class="class">.sinks</span><span class="class">.kafkaSink</span><span class="class">.type</span> = org<span class="class">.apache</span><span class="class">.flume</span><span class="class">.sink</span><span class="class">.kafka</span><span class="class">.KafkaSink</span>
agent<span class="class">.sinks</span><span class="class">.kafkaSink</span><span class="class">.topic</span> = flume_test
agent<span class="class">.sinks</span><span class="class">.kafkaSink</span><span class="class">.brokerList</span> = kafka:<span class="number">9092</span>
agent<span class="class">.sinks</span><span class="class">.kafkaSink</span><span class="class">.batchSize</span> = <span class="number">200</span>
agent<span class="class">.sinks</span><span class="class">.kafkaSink</span><span class="class">.channel</span> = memChannel
</code></pre><h2 id="Flume_Benchmark_Results">Flume Benchmark Results</h2><h3 id="5K_mps">5K mps</h3><p><img src="/images/flume_heka/flume_5k_mps.png" alt="Alt text"></p>
<p><img src="/images/flume_heka/flume_5k_mem.png" alt="Alt text"></p>
<h3 id="10K_mps">10K mps</h3><p><img src="/images/flume_heka/flume_10k_mps.png" alt="Alt text"></p>
<p><img src="/images/flume_heka/flume_10k_mem.png" alt="Alt text"></p>
<h3 id="50K_mps">50K mps</h3><p><img src="/images/flume_heka/flume_50k_mps.png" alt="Alt text"></p>
<p><img src="/images/flume_heka/flume_50k_mem.png" alt="Alt text"></p>
<h1 id="Heka_Benchmarks">Heka Benchmarks</h1><h2 id="Heka_Configuration">Heka Configuration</h2><pre><code><span class="title">[accesslogs]</span>
<span class="setting">type = <span class="value"><span class="string">"LogstreamerInput"</span></span></span>
<span class="setting">log_directory = <span class="value"><span class="string">"/tmp"</span></span></span>
<span class="setting">file_match = <span class="value"><span class="string">'example\.log'</span></span></span>
<span class="title">
[PayloadEncoder]</span>
<span class="setting">append_newlines = <span class="value"><span class="keyword">false</span></span></span>
<span class="title">
[KafkaOutput]</span>
<span class="setting">type = <span class="value"><span class="string">"KafkaOutput"</span></span></span>
<span class="setting">message_matcher = <span class="value"><span class="string">"TRUE"</span></span></span>
<span class="setting">topic = <span class="value"><span class="string">"heka_test"</span></span></span>
<span class="setting">addrs = <span class="value">[<span class="string">"kafka:9092"</span>]</span></span>
<span class="setting">encoder = <span class="value"><span class="string">"PayloadEncoder"</span></span></span>
<span class="setting">max_buffer_time = <span class="value"><span class="number">1000</span></span></span>
<span class="setting">max_buffered_bytes = <span class="value"><span class="number">1048576</span></span></span>
<span class="setting">required_acks = <span class="value"><span class="string">"NoResponse"</span></span></span>
</code></pre><h2 id="Heka_Benchmark_Results">Heka Benchmark Results</h2><h3 id="5K_mps-1">5K mps</h3><p><img src="/images/flume_heka/heka_5k_mps.png" alt="Alt text"></p>
<p><img src="/images/flume_heka/heka_5k_mem.png" alt="Alt text"></p>
<h3 id="10K_mps-1">10K mps</h3><p><img src="/images/flume_heka/heka_10k_mps.png" alt="Alt text"></p>
<p><img src="/images/flume_heka/heka_10k_mem.png" alt="Alt text"></p>
<h3 id="50K_mps-1">50K mps</h3><p><img src="/images/flume_heka/heka_50k_mps.png" alt="Alt text"></p>
<p><img src="/images/flume_heka/heka_50k_mem.png" alt="Alt text"></p>
<h1 id="The_Comparison">The Comparison</h1><h2 id="About_Performance">About Performance</h2><p>As the charts said, both Flume and Heka can handle huge amout of log in very high speed. We usually deploy them on servers which act as business usage. That means, it would not take much pressure (if we use them behind Apache Kafka - another usage type is sending date <strong>TO</strong> Kafka, they could work well). Considering the Linux system costs, Heka takes advantages on %MEM while Flume does on %CPU. Heka is written in Golang so that the memory usage is much lower than Flume which is Java made. For %CPU, Flume uses less cpu than Heka. Chars are below:</p>
<p><img src="/images/flume_heka/total_mem.png" alt="Alt text"></p>
<p><img src="/images/flume_heka/total_cpu.png" alt="Alt text"></p>
<h2 id="About_Usability">About Usability</h2><h3 id="Features">Features</h3><p>Flume’s configuration files are written in YAML while Heka’s in TOML. We can find out that writing in TOML is much more simple than YAML as well as we can understand more easily. As for the architectures, Flume is easier. It contains three main components - Source, Channel and Sink. <code>Source</code> defines the date source; <code>Sink</code> defines the destination of the date; <code>Channel</code> is the buffer date pipeline between <code>Source</code> and <code>Sink</code>. In our exmple, log files is the <code>Source</code> and Kafka is the <code>Sink</code>. <code>Source</code> puts date into <code>Channel</code> while <code>Sink</code> takes date from <code>Channel</code>. The architecture is like below:</p>
<p><img src="/images/flume_heka/flume_arch.png" alt="Alt text"></p>
<p>For Heka, its architecture is a little complex. Its <code>Inputs</code>, <code>Outputs</code> are like Flume’s <code>Source</code> and <code>Sink</code>. Heka adds many feature such as <code>Splitter</code>, <code>Decoder</code>, <code>Filter</code> and <code>Encoder</code> in addition. These feature enable Heka to handle date directly in Heka itself, in the same time, make Heka a more powerful tool in comparison of Flume. The architecture is like below: </p>
<p><img src="/images/flume_heka/heka_arch" alt="Alt text"></p>
<h3 id="Monitor">Monitor</h3><p>Both Flume and Heka enables HTTP API to get metrics. </p>
<p>For Flume, we can add JVM parameters <code>-Dflume.monitoring.type=http -Dflume.monitoring.port=34545</code> to enable the HTTP API. And the date is like below (by <code>curl -s localhost:34545/metrics | python -m json.tool</code>):</p>
<pre><code><span class="collection">{
       <span class="string">"CHANNEL.memChannel"</span>: <span class="collection">{
           <span class="string">"ChannelCapacity"</span>: <span class="string">"1000000"</span>,
           <span class="string">"ChannelFillPercentage"</span>: <span class="string">"0.0"</span>,
           <span class="string">"EventPutAttemptCount"</span>: <span class="string">"10"</span>,
           <span class="string">"EventPutSuccessCount"</span>: <span class="string">"10"</span>,
           <span class="string">"EventTakeAttemptCount"</span>: <span class="string">"16"</span>,
           <span class="string">"EventTakeSuccessCount"</span>: <span class="string">"10"</span>,
           <span class="string">"StartTime"</span>: <span class="string">"1458887648261"</span>,
           <span class="string">"StopTime"</span>: <span class="string">"0"</span>,
           <span class="string">"Type"</span>: <span class="string">"CHANNEL"</span>
           }</span>,
           ...
   }</span>
</code></pre><p>For Heka, we need to add this in to its configuration file, <code>ticker_interval</code> defines the interval Heka refresh the data:</p>
<pre><code><span class="title">[DashboardOutput]</span>
<span class="setting">ticker_interval = <span class="value"><span class="number">1</span></span></span>
</code></pre><p>The result is like (by ``):</p>
<pre><code><span class="string">"outputs"</span>: [{
    <span class="string">"Name"</span>: <span class="string">"KafkaOutput"</span>,
    <span class="string">"ProcessMessageCount"</span>: {
        <span class="string">"representation"</span>: <span class="string">"count"</span>,
        <span class="string">"value"</span>: <span class="number">756698</span>
    },
    <span class="string">"ProcessMessageDiscards"</span>: {
        <span class="string">"representation"</span>: <span class="string">"count"</span>,
        <span class="string">"value"</span>: <span class="number">0</span>
    },
    <span class="string">"ProcessMessageFailures"</span>: {
        <span class="string">"representation"</span>: <span class="string">"count"</span>,
        <span class="string">"value"</span>: <span class="number">0</span> }
    },
    ...
}
</code></pre><h3 id="Problems">Problems</h3><ol>
<li><p>Flume cannot read log file continously after restart. Flume uses <code>tail</code> to get log lines from log files so Flume does not know which line it has read or which line it need to start to read after Flume restarts. Heka will keep offset in a meta file and can read the date continously after restarting. In this point, Heka is better.</p>
</li>
<li><p>Flume cannot update log files according to the configurations. For example, we defined we need to get log files named ‘access_*.log’, Flume will not get the files working only when we modify the configuration files. For Heka, Heka will monitor the directory and update the log files in some interval time which is set in configuration files. The parameter is <code>rescan_interval</code>:</p>
</li>
</ol>
<blockquote>
<p>During logfile rotation, or if the logfile is not originally present on the system, this interval is how often the existence of the logfile will be checked for. The default of 5 seconds is usually fine. This interval is in milliseconds.</p>
</blockquote>
<h1 id="Conclusions">Conclusions</h1><p>Both Flume and Heka are good choice for our solutions. Heka is written Golang and we can start/stop it in seconds. For Flume, it always takes minutes to initialize or stop. And Heka can handle the circumstance of continoulsy reading while Flume can not. I think Heka would be a better choice.</p>
<p>But the bad news is that Heka is deprecated by mozilla in May of 2016. We can get the detail inforation <a href="https://mail.mozilla.org/pipermail/heka/2016-May/001059.html" target="_blank" rel="external">here</a>. I thinks there are too many features in Heka and that makes Heka a heavy tool. I like it very much and my plan is to remove the additional components of Heka and make it a simple but powerful tool.</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/08/25/Simple-Method-to-Compare-to-JSON-in-Python/" itemprop="url">
                Simple Method to Compare to JSON in Python
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on
          <time itemprop="dateCreated" datetime="2016-08-25T17:20:58+08:00" content="2016-08-25">
            2016-08-25
          </time>
        </span>

        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2016/08/25/Simple-Method-to-Compare-to-JSON-in-Python/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/08/25/Simple-Method-to-Compare-to-JSON-in-Python/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h1 id="Problem">Problem</h1><p>Recently I met a problem about how to compare to JSON. As we know, JSON is dict-like data structure, the order of its content is not import in the comparison. For example, <code>{&#39;name&#39;: &#39;frank&#39;, &#39;age&#39;: &#39;12&#39;}</code> equals <code>{&#39;age&#39;: &#39;12&#39;, &#39;name&#39;: &#39;frank&#39;}</code>. In the real world, perhaps there are some more complex data structures like list, tuple or nested-dict. </p>
<h1 id="Solutions">Solutions</h1><p>In python(both python2 and python3), we can use <code>pprint</code> to get pretty print for JSON and other data structures. It will sort and format data first. And there is another method in <code>pprint</code> module called <code>pformat</code> which is used to get the output to a string. Let’s see the example.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pprint</span><br><span class="line"></span><br><span class="line">d1 = &#123;<span class="string">'name'</span>: <span class="string">'frank'</span>, <span class="string">'age'</span>: <span class="string">'12'</span>&#125;</span><br><span class="line">pformat_d1 = pprint.pformat(d1) <span class="comment"># pformat_d1: &#123;'age': '12', 'name': 'frank'&#125;</span></span><br><span class="line">d2 = &#123;<span class="string">'age'</span>: <span class="string">'12'</span>, <span class="string">'name'</span>: <span class="string">'frank'</span>&#125;</span><br><span class="line">pformat_d2 = pprint.pformat(d2) <span class="comment"># pformat_d2: &#123;'age': '12', 'name': 'frank'&#125;</span></span><br></pre></td></tr></table></figure></span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/08/05/Run-pyspark-in-Python3/" itemprop="url">
                Run pyspark in Python3
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on
          <time itemprop="dateCreated" datetime="2016-08-05T17:47:53+08:00" content="2016-08-05">
            2016-08-05
          </time>
        </span>

        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2016/08/05/Run-pyspark-in-Python3/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/08/05/Run-pyspark-in-Python3/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h1 id="Backgroud">Backgroud</h1><p>We were using spark in Scala environment for a long time and it did its job well. Now we need to query spark in python3 scripts and this post is a simple how-to guide for pyspark.</p>
<h1 id="Prerequisites">Prerequisites</h1><ol>
<li>jdk</li>
<li>spark</li>
<li>python3</li>
<li>set <code>JAVA_HOME</code> and <code>SPARK_HOME</code> in env</li>
</ol>
<p><code>pyspark</code> is in your <code>SPARK_HOME/python</code>, you need to put it into you python path. You can <code>cp</code> or <code>ln</code> the directory to you python3 path, another method is use <code>sys.path.append</code> in your scripts.</p>
<h1 id="Example">Example</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyspark <span class="keyword">import</span> SparkContext, SparkConf</span><br><span class="line"><span class="keyword">from</span> pyspark.sql <span class="keyword">import</span> HiveContext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    conf = SparkConf()</span><br><span class="line">    conf.set(<span class="string">'spark.executor.memory'</span>, <span class="string">'16g'</span>)</span><br><span class="line">    sc = SparkContext(<span class="string">'spark://10.3.99.42:7077'</span>, appName=<span class="string">'test'</span>, conf=conf)</span><br><span class="line">    sc.setLogLevel(<span class="string">'ERROR'</span>)</span><br><span class="line">    hiveContext = HiveContext(sc)</span><br><span class="line">    hiveContext.setConf(<span class="string">'hive.metastore.uris'</span>, <span class="string">'thrift://127.0.0.1:9083'</span>)</span><br><span class="line">    hiveContext.setConf(<span class="string">'io.compression.codecs'</span>, <span class="string">'org.apache.hadoop.io.compress.SnappyCodec'</span>)</span><br><span class="line">    hiveContext.sql(<span class="string">'use default'</span>)</span><br><span class="line">    hiveContext.sql(<span class="string">"select * from table"</span>).show()</span><br></pre></td></tr></table></figure></span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/07/08/Enable-lzo-in-Spark-and-IntelliJ-IDEA/" itemprop="url">
                Enable lzo in Spark and IntelliJ IDEA
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on
          <time itemprop="dateCreated" datetime="2016-07-08T09:32:13+08:00" content="2016-07-08">
            2016-07-08
          </time>
        </span>

        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2016/07/08/Enable-lzo-in-Spark-and-IntelliJ-IDEA/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/07/08/Enable-lzo-in-Spark-and-IntelliJ-IDEA/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h1 id="Intro">Intro</h1><p>LZO is a compression codec for Hadoop-environment component like hadoop, hbase, spark and so on. The problem I met is that I want to read and calculate data from Hive table in lzo by SparkSQL. In this post, I will show you how to enable lzo in a Spark box without extra hadoop lib and run SparkSQL in Intellij IDEA in Mac.</p>
<h1 id="Box">Box</h1><ul>
<li>spark-1.6.2-bin-hadoop2.6</li>
<li>jdk-1.7</li>
<li>hadoop-lzo-0.4.20</li>
<li>maven3</li>
</ul>
<p>Spark node run on CentOS 7, and Intellij IDEA is on OS X EI Capitan.</p>
<h1 id="Enable_lzo_in_spark_node">Enable lzo in spark node</h1><p>You can run spark in standalone without any other component, so it is easy to test wheather we have enable lzo. </p>
<h4 id="Install_linux_lzo_dependencies_by_yum">Install linux lzo dependencies by yum</h4><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum <span class="keyword">install</span> -y lzo-devel lzop</span><br></pre></td></tr></table></figure>
<h4 id="clone_hadoop-lzo_repo_from_github">clone hadoop-lzo repo from github</h4><p>Clone it at <a href="https://github.com/twitter/hadoop-lzo" target="_blank" rel="external">https://github.com/twitter/hadoop-lzo</a>. Then use maven.</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone <span class="string">https:</span><span class="comment">//github.com/twitter/hadoop-lzo</span></span><br><span class="line">cd hadoop-lzo</span><br><span class="line">mvn <span class="keyword">package</span></span><br></pre></td></tr></table></figure>
<p>After package it, you will get a jar named <code>hadoop-lzo-0.4.20-SNAPSHOT.jar</code> in <code>target</code> directory.</p>
<h4 id="Add_jar_to_spark_env_by_set_env_in_${SPARK_HOME}/conf/spark-conf-sh-">Add jar to spark env by set env in <code>${SPARK_HOME}/conf/spark-conf.sh</code>.</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> SPARK_CLASSPATH=$&#123;HADOOP-LZO_HOME&#125;/target/hadoop-lzo-<span class="number">0.4</span><span class="number">.20</span>-SNAPSHOT.jar</span><br></pre></td></tr></table></figure>
<p><code>${SPARK_HOME}</code> and <code>${HADOOP-LZO_HOME}</code> is the directory you put spark and hadoop-lzo repo.</p>
<h4 id="Run_spark_in_standalone_mode-">Run spark in standalone mode.</h4><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="label">$&#123;SPARK_HOME&#125;</span></span><br><span class="line">./sbin/start-master.<span class="keyword">sh</span></span><br><span class="line">./sbin/start-slave.<span class="keyword">sh</span> spark:<span class="comment">//$&#123;SPARK_IP&#125;:$&#123;SPARK_PORT&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="Test_if_lzo_is_availabe_in_spark_by_spark-shell-">Test if lzo is availabe in spark by <code>spark-shell</code>.</h4><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">cd $&#123;SPARK_HOME&#125;</span><br><span class="line">./bin/spark-shell</span><br><span class="line">scala&gt; sqlContext.setConf(<span class="string">"hive.metastore.uris"</span>, <span class="string">"thrift://cloudera-server:9083"</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; sqlContext.setConf(<span class="string">"io.compression.codecs"</span>, <span class="string">"com.hadoop.compression.lzo.LzoCodec,com.hadoop.compression.lzo.LzopCodec"</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; sqlContext.sql(<span class="string">"use default"</span>)</span><br><span class="line">res2: org.apache.spark.sql.DataFrame = [result: string]</span><br><span class="line"></span><br><span class="line">scala&gt; sqlContext.sql(<span class="string">"select cdn_ip, timestamp from total_cdn_log where date='2016-07-05' and hour='01' limit 10"</span>).show()</span><br><span class="line">+-----------+----------+</span><br><span class="line">|<span class="string">     cdn_ip</span>|<span class="string"> timestamp</span>|</span><br><span class="line">+-----------+----------+</span><br><span class="line">|<span class="string">cdn_ip_none</span>|<span class="string">1467651600</span>|</span><br><span class="line">|<span class="string">cdn_ip_none</span>|<span class="string">1467651600</span>|</span><br><span class="line">|<span class="string">cdn_ip_none</span>|<span class="string">1467651600</span>|</span><br><span class="line">|<span class="string">cdn_ip_none</span>|<span class="string">1467651600</span>|</span><br><span class="line">|<span class="string">cdn_ip_none</span>|<span class="string">1467651600</span>|</span><br><span class="line">|<span class="string">cdn_ip_none</span>|<span class="string">1467651600</span>|</span><br><span class="line">|<span class="string">cdn_ip_none</span>|<span class="string">1467651600</span>|</span><br><span class="line">|<span class="string">cdn_ip_none</span>|<span class="string">1467651600</span>|</span><br><span class="line">|<span class="string">cdn_ip_none</span>|<span class="string">1467651600</span>|</span><br><span class="line">|<span class="string">cdn_ip_none</span>|<span class="string">1467651600</span>|</span><br><span class="line">+-----------+----------+</span><br></pre></td></tr></table></figure>
<p>We must set <code>io.compression.codecs</code> to <code>com.hadoop.compression.lzo.LzoCodec,com.hadoop.compression.lzo.LzopCodec</code> because spark use snappy codec in default.</p>
<h1 id="Enable_lzo_in_IntelliJ_IDEA">Enable lzo in IntelliJ IDEA</h1><p>I think you have make your SparkSQL job running - that is to say, scala box is okay in your IntelliJ IDEA. Mac OS is a little different with RedHat because it is based on FreeBSD and NetBSD’s implementions.</p>
<h4 id="Install_lzo_dependencies_by_brew">Install lzo dependencies by <code>brew</code></h4><p><code>brew</code> is an excellent package management tool in Mac which its full name is <code>Homebrew</code>. If you have not installed <code>brew</code>, you can go to its website <a href="http://brew.sh/" target="_blank" rel="external">http://brew.sh/</a>. Its install is easy with only one line command.</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/usr/</span>bin<span class="regexp">/ruby -e "$(curl -fsSL https:/</span><span class="regexp">/raw.githubusercontent.com/</span>Homebrew<span class="regexp">/install/m</span>aster<span class="regexp">/install)"</span></span><br></pre></td></tr></table></figure>
<p>Okay, let’s install <code>lzo</code> dependencies.</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">brew </span>install lzo lzop</span><br></pre></td></tr></table></figure>
<h4 id="Package_hadoop-lzo">Package <code>hadoop-lzo</code></h4><p><strong>REMARK:</strong> Please <strong>DO NOT</strong> copy the <code>hadoop-lzo</code> from other system - such as CentOS that we run spark on. Because the maven procedure in <code>hadoop-lzo</code> contains some <code>gcc</code> process which is strongly connected with the system.</p>
<p>To build <code>hadoop-lzo</code>, we need to specify the location we install <code>lzo</code>. </p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>brew list lzo</span><br><span class="line">/usr/local/<span class="constant">Cellar</span>/lzo/<span class="number">2.09</span>/<span class="keyword">include</span>/lzo/ (<span class="number">13</span> files)</span><br><span class="line">/usr/local/<span class="constant">Cellar</span>/lzo/<span class="number">2.09</span>/<span class="class"><span class="keyword">lib</span>/<span class="title">liblzo2</span>.2.<span class="title">dylib</span></span></span><br><span class="line">/usr/local/<span class="constant">Cellar</span>/lzo/<span class="number">2.09</span>/<span class="class"><span class="keyword">lib</span>/ (2 <span class="title">other</span> <span class="title">files</span>)</span></span><br><span class="line">/usr/local/<span class="constant">Cellar</span>/lzo/<span class="number">2.09</span>/share/doc/ (<span class="number">7</span> files)</span><br></pre></td></tr></table></figure>
<p>Then we can get <code>hadoop-lzo</code> and package jar.</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git clone <span class="string">https:</span><span class="comment">//github.com/twitter/hadoop-lzo</span></span><br><span class="line">$ cd hadoop-lzo</span><br><span class="line">$ C_INCLUDE_PATH=<span class="regexp">/usr/</span>local<span class="regexp">/Cellar/</span>lzo<span class="regexp">/2.09/</span>include<span class="regexp">/ LIBRARY_PATH=/</span>usr<span class="regexp">/local/</span>Cellar<span class="regexp">/lzo/</span><span class="number">2.09</span><span class="regexp">/lib/</span>   mvn clean <span class="keyword">package</span></span><br></pre></td></tr></table></figure>
<p><strong>REMARK:</strong> The guide <a href="https://gist.github.com/zedar/c43cbc7ff7f98abee885" target="_blank" rel="external">https://gist.github.com/zedar/c43cbc7ff7f98abee885</a> - Add LZO compresssion codecs to the Apache Hadoop and Spark is little wrong for set <code>C_INCLUDE_PATH</code>. In the guide, he said<br><code>C_INCLUDE_PATH=/usr/local/Cellar/lzo/2.06/include/lzo/</code>, it should be <code>C_INCLUDE_PATH=/usr/local/Cellar/lzo/2.09/include/</code>. We do not need add lzo suffix.</p>
<h4 id="Config_the_IntelliJ_IDEA_box">Config the IntelliJ IDEA box</h4><p>The first step is add <code>hadoop-lzo-0.4.20-SNAPSHOT.jar</code> to your scala project.</p>
<p><img src="/images/idea_lzo_add_jar.png" alt="Alt text"></p>
<p>The next step is add <code>java.library.path</code> to your jvm options in your menu <code>Run-Edit configurations...</code>. The option you need to add is like <code>-Djava.library.path=/Users/yaorenjie/Documents/git/hadoop-lzo/target</code></p>
<p><img src="/images/idea_lzo_add_jvm.png" alt="Alt text"></p>
<p><strong>REMARK:</strong> You must specify the build directory you run maven. If you want to use other directory, you <strong>MUST</strong> move all files in <code>target</code>. The <code>hadoop-lzo</code> need native <code>gpl</code> library in <code>target</code> directory.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ll native/Mac_OS_X-x86_64-<span class="number">64</span>/lib</span><br><span class="line">total <span class="number">208</span></span><br><span class="line">-rwxr-xr-x  <span class="number">1</span> yaorenjie  staff  <span class="number">21780</span> Jul  <span class="number">7</span> <span class="number">17</span>:<span class="number">36</span> libgplcompression<span class="number">.0</span>.dylib</span><br><span class="line">-rw-r--r--  <span class="number">1</span> yaorenjie  staff   <span class="number">1164</span> Jul  <span class="number">7</span> <span class="number">17</span>:<span class="number">36</span> libgplcompression.la</span><br><span class="line">lrwxr-xr-x  <span class="number">1</span> yaorenjie  staff     <span class="number">25</span> Jul  <span class="number">7</span> <span class="number">17</span>:<span class="number">36</span> libgplcompression.dylib -&gt; libgplcompression<span class="number">.0</span>.dylib</span><br><span class="line">-rw-r--r--  <span class="number">1</span> yaorenjie  staff  <span class="number">69744</span> Jul  <span class="number">7</span> <span class="number">17</span>:<span class="number">36</span> libgplcompression.a</span><br></pre></td></tr></table></figure>
<p>If you want to dig it out, you can get this process in <code>GPLNativeCodeLoader</code></p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/07/04/Connect-MySQL-with-ssh-tunnel-in-Python/" itemprop="url">
                Connect MySQL with ssh tunnel in Python
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on
          <time itemprop="dateCreated" datetime="2016-07-04T14:45:41+08:00" content="2016-07-04">
            2016-07-04
          </time>
        </span>

        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2016/07/04/Connect-MySQL-with-ssh-tunnel-in-Python/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/07/04/Connect-MySQL-with-ssh-tunnel-in-Python/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>Sometimes you can only connect to MySQL via a certain server for security reasons. But apparently, coding in IDE(e.g PyCharm) is easier. For this circumstance, we can use <a href="https://pypi.python.org/pypi/sshtunnel" target="_blank" rel="external">sshtunnel</a>.</p>
<p>So we have a MySQL server on <code>127.0.0.3:3306</code>, its mysql login name and password is <code>MYSQL_USER</code> and <code>MYSQL_PASSWORD</code>. And we can only connect to this mysql via server <code>127.0.0.2:22</code>, and its login name and password is <code>root</code> and <code>SERVER_PASSWORD</code>. Let’s figure out how <code>sshtunnel</code> is working.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> SSHTunnelForwarder((<span class="string">'127.0.0.2'</span>, <span class="number">22</span>), ssh_password=<span class="string">'SERVER_PASSWORD'</span>, ssh_username=<span class="string">'root'</span>, remote_bind_address=(<span class="string">'127.0.0.3'</span>, <span class="number">3306</span>)) <span class="keyword">as</span> server:</span><br><span class="line">       conn = MySQLdb.connect(host=<span class="string">'127.0.0.1'</span>, port=server.local_bind_port, user=<span class="string">'MYSQL_USER'</span>, passwd=<span class="string">'MYSQL_PASSWORD'</span>)</span><br><span class="line">       cursor = conn.cursor()</span><br></pre></td></tr></table></figure>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/06/20/Using-pip-and-easy-install-with-Chinese-repo/" itemprop="url">
                Using pip and easy_install with Chinese repo
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on
          <time itemprop="dateCreated" datetime="2016-06-20T15:47:16+08:00" content="2016-06-20">
            2016-06-20
          </time>
        </span>

        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2016/06/20/Using-pip-and-easy-install-with-Chinese-repo/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/06/20/Using-pip-and-easy-install-with-Chinese-repo/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>For some reasons, <code>pypi.python.org</code> is not available or has a slow download rate. We can simply using <a href="http://pypi.douban.com/simple" target="_blank" rel="external">douban pypi</a> or <a href="http://pypi.v2ex.com/simple" target="_blank" rel="external">v2ex pypi</a> by two ways.</p>
<h2 id="edit_env">edit env</h2><p>Edit env will enable <code>pip</code> using own pypi in default. In Linux and Mac, the file is in <code>%HOME/.pip/pip.conf</code>. And the content is:</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[global]</span><br><span class="line"><span class="keyword">find</span>-links=http:<span class="comment">//pypi.douban.com/simple</span></span><br><span class="line">[install]</span><br><span class="line"><span class="keyword">find</span>-links=</span><br><span class="line">    http:<span class="comment">//pypi.douban.com/simple</span></span><br><span class="line">    http:<span class="comment">//pypi.v2ex.com/simple</span></span><br></pre></td></tr></table></figure></span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/06/09/Build-Jasig-CAS-from-Zero-1-Build-CAS-Server/" itemprop="url">
                Build Jasig CAS from Zero (1)  - Build CAS Server
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on
          <time itemprop="dateCreated" datetime="2016-06-09T10:54:17+08:00" content="2016-06-09">
            2016-06-09
          </time>
        </span>

        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2016/06/09/Build-Jasig-CAS-from-Zero-1-Build-CAS-Server/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/06/09/Build-Jasig-CAS-from-Zero-1-Build-CAS-Server/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h1 id="Download_source_tarball_from_github">Download source tarball from github</h1><p>You can get CAS from git easily:)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https:<span class="comment">//github.com/apereo/cas.git</span></span><br><span class="line">git fetch</span><br><span class="line">git checkout <span class="number">4.2</span>.x</span><br></pre></td></tr></table></figure>
<p>The master branch is not a can-be-compiled version. I got failure information when I run compile commands in <code>master</code> branch:</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$./dev-build-<span class="keyword">no</span>-tests.<span class="keyword">sh</span></span><br><span class="line"></span><br><span class="line">FAILURE: Build failed with <span class="keyword">an</span> exception.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Where:</span></span><br><span class="line">Build <span class="keyword">file</span> '/private/tmp/cas/cas-management-webapp/build.gradle' <span class="keyword">line</span>: 28</span><br><span class="line"></span><br><span class="line"><span class="comment">* What went wrong:</span></span><br><span class="line">A problem occurred evaluating project ':cas-management-webapp'.</span><br><span class="line">&gt; <span class="keyword">No</span> such property: java <span class="keyword">for</span> <span class="keyword">class</span>: org.gradle.api.java.archives.internal.DefaultManifest</span><br><span class="line"></span><br><span class="line"><span class="comment">* Try:</span></span><br><span class="line"><span class="keyword">Run</span> with --stacktrace option to get the <span class="keyword">stack</span> trace. <span class="keyword">Run</span> with --info or --debug option to get <span class="keyword">more</span> <span class="keyword">log</span> output.</span><br><span class="line"></span><br><span class="line">BUILD FAILED</span><br><span class="line"></span><br><span class="line"><span class="keyword">Total</span> time: 11.67 secs</span><br></pre></td></tr></table></figure>
<p>The stable version version in <a href="https://github.com/apereo/cas/releases" target="_blank" rel="external">cas release page</a> is 4.2.2. So just checkout out the stable version.</p>
<h1 id="compile">compile</h1><h2 id="get_gradle">get gradle</h2><p>CAS can be compiled by <code>gradle</code>, when you first run <code>gradlew</code>(gradle wrapper), the project will download gradle-XXX-bin.zip. If you already have it or you have some problems downloading it(such as GFW), you can simply edit `{CAS_PWD}/gradle/wrapper/gradle-wrapper.properties” like below:</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="setting">distributionBase=<span class="value">GRADLE_USER_HOME</span></span></span><br><span class="line"><span class="setting">distributionPath=<span class="value">wrapper/dists</span></span></span><br><span class="line"><span class="setting">zipStoreBase=<span class="value">GRADLE_USER_HOME</span></span></span><br><span class="line"><span class="setting">zipStorePath=<span class="value">wrapper/dists</span></span></span><br><span class="line"><span class="setting">distributionUrl=<span class="value">https\://services.gradle.org/distributions/gradle-<span class="number">2.13</span>-all.zip</span></span></span><br></pre></td></tr></table></figure>
<p>Replace <code>distributionUrl</code> with your own url.</p>
<p>If you have local gradle zip file, use the zip file name directly and put zip file into <code>{CAS_PWD}/gradle/wrapper</code>. For example if my gradle zip file is <code>gradle-2.10-bin.zip</code>, you need parameter <code>distributionUrl</code> like this:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">...</span><br><span class="line"></span>distributionUtl=gradle-2.10-bin.zip</span><br></pre></td></tr></table></figure>
<h2 id="compile_cas_project">compile cas project</h2><p>There is two bootstrap shell in cas directory, <code>dev-build.sh</code> and <code>dev-build-no-tests.sh</code>. The difference between them is obviously shown in their names - <code>dev-build-no-tests.sh</code> will set this flag <code>-DskipAspectJ=true</code></p>
<p>When you run <code>dev-build.sh</code> or <code>dev-build-no-tests.sh</code> for a couple of minutes, you will probably get this conflicts failure.</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">:cas-server-support-pac4j</span><span class="symbol">:compileAspect</span></span><br><span class="line"><span class="constant">Download </span>...</span><br><span class="line">&gt; <span class="symbol">:cas-server-support-pac4j</span><span class="symbol">:compileAspecFAILED</span></span><br><span class="line"></span><br><span class="line"><span class="constant">FAILURE:</span> <span class="constant">Build </span>failed with an exception.</span><br><span class="line"></span><br><span class="line">* <span class="constant">What </span>went <span class="symbol">wrong:</span></span><br><span class="line"><span class="constant">Execution </span>failed <span class="keyword">for</span> task <span class="string">':cas-server-support-pac4j:compileAspect'</span>.</span><br><span class="line">&gt; <span class="constant">Could </span><span class="keyword">not</span> resolve all dependencies <span class="keyword">for</span> configuration <span class="string">':cas-server-support-pac4j:compile'</span>.</span><br><span class="line">   &gt; <span class="constant">A </span>conflict was found between the following <span class="symbol">modules:</span></span><br><span class="line">      - commons-<span class="symbol">io:</span>commons-<span class="symbol">io:</span><span class="number">2.4</span></span><br><span class="line">      - commons-<span class="symbol">io:</span>commons-<span class="symbol">io:</span><span class="number">2.5</span></span><br><span class="line"></span><br><span class="line">* <span class="constant">Try:</span></span><br><span class="line"><span class="constant">Run </span>with --stacktrace option to get the stack trace. <span class="constant">Run </span>with --info <span class="keyword">or</span> --debug option to get more log output.</span><br><span class="line"></span><br><span class="line"><span class="constant">BUILD FAILED</span></span><br><span class="line"></span><br><span class="line"><span class="constant">Total </span><span class="symbol">time:</span> <span class="number">10</span> mins <span class="number">48.643</span> secs</span><br></pre></td></tr></table></figure>
<p>It is casuse by the conflict between <code>commons-io:2.4</code> and <code>commons-io:2.5</code> in <code>cas-server-support-pac4j</code>, we need to add <code>-DskipVersionConflict=true</code> in bootstrap scripts.</p>
<p>If you build it in IntelliJ IDEA, set this parameter in <code>Preferences-Build,Execution,Deployment-Build Tools-Gradle-Gradle VM options</code>.</p>
<p>Plus, if you want to use http proxy in gradle, you need to set these parameters:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-DproxySet=<span class="literal">true</span> -DproxyHost=<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> -DproxyPort=<span class="number">8123</span></span><br></pre></td></tr></table></figure>
<h2 id="For_IDE">For IDE</h2><p>We need to execute extra command for IDE</p>
<h3 id="IDEA">IDEA</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew idea</span><br></pre></td></tr></table></figure>
<h3 id="Eclipse">Eclipse</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew eclipse</span><br></pre></td></tr></table></figure>
<h1 id="To_Be_Contined…w">To Be Contined…w</h1></span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/05/19/Awesome-dataviz/" itemprop="url">
                Awesome dataviz
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on
          <time itemprop="dateCreated" datetime="2016-05-19T10:42:15+08:00" content="2016-05-19">
            2016-05-19
          </time>
        </span>

        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2016/05/19/Awesome-dataviz/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/05/19/Awesome-dataviz/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>From <a href="https://github.com/fasouto/awesome-dataviz" target="_blank" rel="external">fasouto github</a></p>
<h1 id="Awesome_dataviz">Awesome dataviz <a href="https://github.com/sindresorhus/awesome" target="_blank" rel="external"><img src="https://cdn.rawgit.com/sindresorhus/awesome/d7305f38d29fed78fa85652e3a63e154dd8e8829/media/badge.svg" alt="Awesome"></a></h1><p>A curated list of awesome data visualizations frameworks, libraries and software. Inspired by <a href="https://github.com/vinta/awesome-python" target="_blank" rel="external">awesome-python</a>.</p>
<h2 id="Table_of_contents">Table of contents</h2><ul>
<li><a href="#awesome-dataviz">Awesome dataviz</a><ul>
<li><a href="#javascript-tools">JavaScript tools</a><ul>
<li><a href="#charting-libraries">Charting libraries</a></li>
<li><a href="#charting-libraries-for-graphs">Charting libraries for graphs</a></li>
<li><a href="#maps">Maps</a></li>
<li><a href="#d3">d3</a></li>
<li><a href="#dcjs">dc.js</a></li>
<li><a href="#misc">Misc</a></li>
</ul>
</li>
<li><a href="#android-tools">Android tools</a></li>
<li><a href="#c-tools">C++ tools</a></li>
<li><a href="#golang-tools">Golang tools</a></li>
<li><a href="#ios-tools">iOS tools</a></li>
<li><a href="#python-tools">Python tools</a></li>
<li><a href="#r-tools">R tools</a></li>
<li><a href="#ruby-tools">Ruby tools</a></li>
<li><a href="#other-tools">Other tools</a></li>
</ul>
</li>
<li><a href="#resources">Resources</a><ul>
<li><a href="#books">Books</a></li>
<li><a href="#twitter-accounts">Twitter accounts</a></li>
<li><a href="#websites">Websites</a></li>
</ul>
</li>
<li><a href="#contributing">Contributing</a></li>
<li><a href="#license">License</a></li>
</ul>
<h2 id="JavaScript_tools">JavaScript tools</h2><h3 id="Charting_libraries">Charting libraries</h3><ul>
<li><a href="http://c3js.org/" target="_blank" rel="external">C3</a> - a D3-based reusable chart library.</li>
<li><a href="http://www.chartjs.org/" target="_blank" rel="external">Chart.js</a> - Charts with the canvas tag.</li>
<li><a href="http://gionkunz.github.io/chartist-js/" target="_blank" rel="external">Chartist.js</a> - Responsive charts with great browser compatibility.</li>
<li><a href="http://dimplejs.org/" target="_blank" rel="external">Dimple</a> - An object-oriented API for business analytics.</li>
<li><a href="http://dygraphs.com/" target="_blank" rel="external">Dygraphs</a> - Interactive line charts library that works with huge datasets.</li>
<li><a href="https://github.com/ecomfe/echarts" target="_blank" rel="external">Echarts</a> - Highly customizable and interactive charts ready for big datasets.</li>
<li><a href="https://github.com/epochjs/epoch" target="_blank" rel="external">Epoch</a> - Perfect to create real-time charts.</li>
<li><a href="https://github.com/highcharts/highcharts" target="_blank" rel="external">Highcharts</a> - A charting library based on SVG and VML rendering. Free (<a href="http://creativecommons.org/licenses/by-nc/3.0/" target="_blank" rel="external">CC BY-NC</a> for non-profit projects.</li>
<li><a href="http://metricsgraphicsjs.org/" target="_blank" rel="external">MetricsGraphics.js</a> - Optimized for time-series data.</li>
<li><a href="http://morrisjs.github.io/morris.js/" target="_blank" rel="external">Morris.js</a> - Pretty time-series line graphs.</li>
<li><a href="https://github.com/novus/nvd3" target="_blank" rel="external">NVD3</a> - A reusable charting library written in d3.js.</li>
<li><a href="https://github.com/benpickles/peity" target="_blank" rel="external">Peity</a> - Create small inline svg charts.</li>
<li><a href="https://github.com/plotly/plotly.js/" target="_blank" rel="external">Plotly.js</a> - Powerful declarative library with support for 20 chart types.</li>
<li><a href="http://techanjs.org/" target="_blank" rel="external">TechanJS</a> - Stock and financial charts.</li>
</ul>
<h3 id="Charting_libraries_for_graphs">Charting libraries for graphs</h3><ul>
<li><a href="http://marvl.infotech.monash.edu/webcola/" target="_blank" rel="external">Cola.js</a> - A tool to create diagrams using constraint-based optimization techniques. Works with d3 and svg.js.</li>
<li><a href="http://js.cytoscape.org/" target="_blank" rel="external">Cytoscape.js</a> - JavaScript library for graph drawing maintained by <a href="http://www.cytoscape.org" target="_blank" rel="external">Cytoscape</a> core developers.</li>
<li><a href="https://github.com/Linkurious/linkurious.js/" target="_blank" rel="external">Linkurious</a> - A toolkit to speed up the development of graph visualization and interaction applications. Based on Sigma.js.</li>
<li><a href="http://sigmajs.org/" target="_blank" rel="external">Sigma.js</a> - JavaScript library dedicated to graph drawing.</li>
<li><a href="https://github.com/anvaka/VivaGraphJS" target="_blank" rel="external">VivaGraph</a> - Graph drawing library for JavaScript.</li>
</ul>
<h3 id="Maps">Maps</h3><ul>
<li><a href="https://github.com/CartoDB/cartodb" target="_blank" rel="external">CartoDB</a> - CartoDB is an open source tool that allows for the storage and visualization of geospatial data on the web.</li>
<li><a href="https://github.com/AnalyticalGraphicsInc/cesium" target="_blank" rel="external">Cesium</a> - WebGL virtual globe and map engine.</li>
<li><a href="http://leafletjs.com" target="_blank" rel="external">Leaflet</a> - JavaScript library for mobile-friendly interactive maps.</li>
<li><a href="https://github.com/humangeo/leaflet-dvf" target="_blank" rel="external">Leaflet Data Visualization Framework</a>  - A framework designed to simplify data visualization and thematic mapping using Leaflet.</li>
<li><a href="https://github.com/neveldo/jQuery-Mapael" target="_blank" rel="external">Mapael</a> - jQuery plugin based on the.js to display vector maps.</li>
<li><a href="http://mapsense.github.io/mapsense.js/" target="_blank" rel="external">Mapsense.js</a> - Combines d3.js with tile maps.</li>
<li><a href="http://modestmaps.com/" target="_blank" rel="external">Modest Maps</a> - BSD-licensed display and interaction library for tile-based maps in Javascript.</li>
</ul>
<h3 id="d3">d3</h3><ul>
<li>See <a href="https://github.com/wbkd/awesome-d3" target="_blank" rel="external">Awesome D3</a>.</li>
</ul>
<h3 id="dc-js">dc.js</h3><p><a href="https://github.com/dc-js/dc.js" target="_blank" rel="external">dc.js</a> is an multi-Dimensional charting built to work natively with crossfilter.</p>
<ul>
<li><a href="https://github.com/TomNeyland/angular-dc" target="_blank" rel="external">angular-dc</a> - AngularJS directives for dc.js.</li>
<li><a href="https://github.com/yurukov/dc.leaflet.js" target="_blank" rel="external">dc.leaflet.js</a> - dc.js charts using Leaflet maps.</li>
<li><a href="https://github.com/andrewreedy/ember-dc" target="_blank" rel="external">ember-dc</a> - Ember Component Wrappers for dc.js.</li>
</ul>
<h3 id="Misc">Misc</h3><ul>
<li><a href="http://gka.github.io/chroma.js/" target="_blank" rel="external">Chroma.js</a> - A small library for color manipulation.</li>
<li><a href="https://github.com/lipka/piecon" target="_blank" rel="external">Piecon</a> - Pie charts in your favicon.</li>
<li><a href="http://okfnlabs.org/recline/" target="_blank" rel="external">Recline.js</a> - Simple but powerful library for building data applications in pure JavaScript and HTML.</li>
<li><a href="http://riccardoscalco.github.io/textures/" target="_blank" rel="external">Textures.js</a> - A library to create SVG patterns.</li>
<li><a href="http://timeline.knightlab.com/" target="_blank" rel="external">Timeline.js</a> -  Create interactive timelines.</li>
<li><a href="http://vega.github.io/vega/" target="_blank" rel="external">Vega</a> - Vega is a visualization grammar, a declarative format for creating, saving, and sharing interactive visualization designs.</li>
<li><a href="http://visjs.org/" target="_blank" rel="external">Vis.js</a> - A dynamic visualization library including timeline, networks and graphs (2D and 3D).</li>
</ul>
<h2 id="Android_tools">Android tools</h2><ul>
<li><a href="https://github.com/lecho/hellocharts-android" target="_blank" rel="external">HelloCharts</a> - Charting library for Android compatible with API 8+.</li>
<li><a href="https://github.com/PhilJay/MPAndroidChart" target="_blank" rel="external">MPAndroidChart</a> - A powerful &amp; easy to use chart library.</li>
</ul>
<h2 id="C++_tools">C++ tools</h2><ul>
<li><a href="https://gitlab.kitware.com/vtk/vtk/blob/master/README.md" target="_blank" rel="external">Visualization Toolkit (VTK)</a> - open-source library for 3d Graphics, image processing and visualization.</li>
</ul>
<h2 id="Golang_tools">Golang tools</h2><ul>
<li><a href="https://github.com/vdobler/chart" target="_blank" rel="external">Charts for Go</a> - Basic charts in Go. Can render to ASCII, SVG and images.</li>
<li><a href="https://github.com/ajstarks/svgo" target="_blank" rel="external">svgo</a> - Go Language Library for SVG generation.</li>
</ul>
<h2 id="iOS_tools">iOS tools</h2><ul>
<li><a href="https://github.com/Jawbone/JBChartView" target="_blank" rel="external">JBChartView</a> - Charting library for both line and bar graphs.</li>
<li><a href="https://github.com/kevinzhow/PNChart" target="_blank" rel="external">PNChart</a> - A simple and beautiful chart lib used in Piner and CoinsMan.</li>
<li><a href="https://github.com/danielgindi/ios-charts" target="_blank" rel="external">ios-charts</a> -  iOS port of MPAndroidChart. You can create charts for both platforms with very similar code.</li>
</ul>
<h2 id="Python_tools">Python tools</h2><ul>
<li><a href="http://bokeh.pydata.org/en/latest/" target="_blank" rel="external">bokeh</a> - Interactive Web Plotting for Python.</li>
<li><a href="https://github.com/yhat/ggplot" target="_blank" rel="external">ggplot</a> - Same API as ggplot2 for R.</li>
<li><a href="https://github.com/glumpy/glumpy" target="_blank" rel="external">glumpy</a> - OpenGL scientific visualizations library.</li>
<li><a href="http://matplotlib.org/" target="_blank" rel="external">matplotlib</a> - 2D plotting library.</li>
<li><a href="http://www.pygal.org/en/latest/" target="_blank" rel="external">pygal</a> - A dynamic SVG charting library.</li>
<li><a href="http://www.pyqtgraph.org/" target="_blank" rel="external">PyQtGraph</a> - Interactive and realtime 2D/3D/Image plotting and science/engineering widgets.</li>
<li><a href="http://stanford.edu/~mwaskom/software/seaborn/" target="_blank" rel="external">seaborn</a> - A library for making attractive and informative statistical graphics.</li>
<li><a href="http://toyplot.readthedocs.org/en/stable/" target="_blank" rel="external">toyplot</a> - The kid-sized plotting toolkit for Python with grownup-sized goals.</li>
<li><a href="https://github.com/wrobstory/vincent" target="_blank" rel="external">Vincent</a> - A Python to Vega translator.</li>
<li><a href="http://vispy.org/" target="_blank" rel="external">VisPy</a> - High-performance scientific visualization based on OpenGL.</li>
<li><a href="https://github.com/mpld3/mpld3" target="_blank" rel="external">mpld3</a> - D3 Renderings of Matplotlib Graphics</li>
</ul>
<h2 id="R_tools">R tools</h2><ul>
<li><a href="http://ggplot2.org/" target="_blank" rel="external">ggplot2</a> - A plotting system based on the grammar of graphics.</li>
<li><a href="http://lattice.r-forge.r-project.org" target="_blank" rel="external">lattice</a> - trellis graphics for R</li>
<li><a href="https://github.com/ropensci/plotly" target="_blank" rel="external">plotly</a> - Interactive charts (including adding interactivity to ggplot2 output), cartograms and simple network diagrams</li>
<li><a href="http://hafen.github.io/rbokeh/" target="_blank" rel="external">rbokeh</a> - R Interface to Bokeh.</li>
<li><a href="https://cran.r-project.org/web/packages/rgl/index.html" target="_blank" rel="external">rgl</a> - 3D Visualization Using OpenGL</li>
<li><a href="http://shiny.rstudio.com" target="_blank" rel="external">shiny</a> - Framework for creating interactive applications/visualisations</li>
<li><a href="http://dataknowledge.github.io/visNetwork/" target="_blank" rel="external">visNetwork</a> - Interactive network visualisations</li>
</ul>
<h2 id="Ruby_tools">Ruby tools</h2><ul>
<li><a href="https://github.com/ankane/chartkick" target="_blank" rel="external">Chartkick</a> - Create charts with one line of Ruby.</li>
</ul>
<h2 id="Other_tools">Other tools</h2><p>Tools that are not tied to a particular platform or language.</p>
<ul>
<li><a href="https://github.com/mikesall/charted" target="_blank" rel="external">Charted</a> - A charting tool that produces automatic, shareable charts from any data file.</li>
<li><a href="https://github.com/gephi/gephi" target="_blank" rel="external">Gephi</a> - An open-source platform for visualizing and manipulating large graphs</li>
<li><a href="http://lightning-viz.org/" target="_blank" rel="external">Lightning</a> - A data-visualization server providing API-based access to reproducible, web-based, interactive visualizations.</li>
<li><a href="http://raw.densitydesign.org/" target="_blank" rel="external">RAW</a> - Create web visualizations from CSV or Excel files.</li>
<li><a href="https://github.com/holman/spark" target="_blank" rel="external">Spark</a> - Sparklines for the shell. It have several <a href="https://github.com/holman/spark/wiki/Alternative-Implementations" target="_blank" rel="external">implementations in different languages</a>.</li>
<li><a href="https://www.periscopedata.com/" target="_blank" rel="external">Periscope</a> - Create charts directly from SQL queries.</li>
</ul>
<h1 id="Resources">Resources</h1><h2 id="Books">Books</h2><ul>
<li><a href="http://www.amazon.com/Design-Information-Introduction-Histories-Visualizations/dp/1592538061" target="_blank" rel="external">Design for Information</a> by Isabel Meirelles.</li>
<li><a href="http://www.amazon.com/The-Best-American-Infographics-2014/dp/0547974515" target="_blank" rel="external">The Best American Infographics 2014</a> by Gareth Cook.</li>
<li><a href="http://www.amazon.com/The-Visual-Display-Quantitative-Information/dp/0961392142" target="_blank" rel="external">The Visual Display of Quantitative Information</a> by Edward Tufte.</li>
<li><a href="http://www.amazon.com/Street-Journal-Guide-Information-Graphics/dp/0393347281" target="_blank" rel="external">The Wall Street Journal Guide to Information Graphics</a> by Dona M. Wong</li>
<li><a href="http://www.amazon.com/Visualization-Analysis-Design-Peters-Series/dp/1466508914" target="_blank" rel="external">Visualization Analysis and Design</a> by Tamara Munzner.</li>
</ul>
<h2 id="Twitter_accounts">Twitter accounts</h2><ul>
<li><a href="https://twitter.com/albertocairo" target="_blank" rel="external">Alberto Cairo</a></li>
<li><a href="https://twitter.com/datavis" target="_blank" rel="external">Benjamin Wiederkehr</a></li>
<li><a href="https://twitter.com/mbostock" target="_blank" rel="external">Mike Bostock</a></li>
<li><a href="https://twitter.com/NadiehBremer" target="_blank" rel="external">Nadieh Bremer</a></li>
<li><a href="https://twitter.com/nytgraphics" target="_blank" rel="external">NYT Graphics</a></li>
<li><a href="https://twitter.com/VisualizingOrg" target="_blank" rel="external">Visualizing</a></li>
</ul>
<h2 id="Websites">Websites</h2><ul>
<li><a href="http://flowingdata.com/" target="_blank" rel="external">FlowingData</a></li>
<li><a href="http://www.informationisbeautiful.net/" target="_blank" rel="external">Information is Beautiful</a></li>
<li><a href="http://www.datavizcatalogue.com/" target="_blank" rel="external">The Data Visualization Catalogue</a> - A collection of data visualization methods, with pros and cons.</li>
<li><a href="http://www.visualcomplexity.com/vc/" target="_blank" rel="external">Visual Complexity</a> - A site about the visualization of complex networks.</li>
</ul>
<h1 id="Contributing">Contributing</h1><ul>
<li>Please check for duplicates first.</li>
<li>Keep descriptions short, simple and unbiased.</li>
<li>Please make an individual commit for each suggestion</li>
<li>Add a new category if needed.</li>
</ul>
<p>Thanks for your suggestions!</p>
<h1 id="License">License</h1><p><a href="http://creativecommons.org/publicdomain/zero/1.0/" target="_blank" rel="external"><img src="https://licensebuttons.net/p/zero/1.0/88x31.png" alt="CC0"></a></p>
<p>To the extent possible under law, <a href="http://fabiosouto.me/" target="_blank" rel="external">Fabio Souto</a> has waived all copyright and related or neighboring rights to this work.</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/12/09/Tricks-on-Crontab/" itemprop="url">
                Tricks on Crontab
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on
          <time itemprop="dateCreated" datetime="2015-12-09T18:01:40+08:00" content="2015-12-09">
            2015-12-09
          </time>
        </span>

        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/12/09/Tricks-on-Crontab/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/12/09/Tricks-on-Crontab/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h1 id="‘@’_in_Crontab">‘@’ in Crontab</h1><p>‘@’ sysmbol is available in crontab and it very useful especially for <code>@reboot</code>. <code>@reboot</code> makes it possible to run a script while machine starts.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@reboot     -   This runs the Cron job when the machine is started up or <span class="keyword">if</span> the Cron daemon is restarted</span><br><span class="line"></span><br><span class="line">@midnight   -   This runs the Cron job once a day at midnight, it<span class="string">'s the equivalent of 0 0 * * *</span><br><span class="line"></span><br><span class="line">@daily      -   Does exactly the same as @midnight</span><br><span class="line"></span><br><span class="line">@weekly     -   This runs a Cron job once a week on a Sunday the equivalent of 0 0 * * 0</span><br><span class="line"></span><br><span class="line">@monthly    -   This runs a Cron job once a month on the first day of every month at midnight and is the same as 0 0 1 * *</span><br><span class="line"></span><br><span class="line">@annually   -   Runs a Cron job once a year at midnight on the first day of the first month and is the equivalent of 0 0  1 1 *</span><br><span class="line"></span><br><span class="line">@yearly     -   The same as annually</span></span><br></pre></td></tr></table></figure>
<p>An example for run a command when the machine starts:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@reboot date &gt;&gt; /tmp/date.log</span><br></pre></td></tr></table></figure>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/12/08/Python-smtplib-to-sendmail-with-STARTTLS-and-UTF8/" itemprop="url">
                Python smtplib to sendmail with STARTTL and UTF8
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on
          <time itemprop="dateCreated" datetime="2015-12-08T09:39:21+08:00" content="2015-12-08">
            2015-12-08
          </time>
        </span>

        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/12/08/Python-smtplib-to-sendmail-with-STARTTLS-and-UTF8/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/12/08/Python-smtplib-to-sendmail-with-STARTTLS-and-UTF8/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h1 id="Intro">Intro</h1><p><code>Python</code> is a very powerful and useful tool in our daily work especially for DevOps. Sending mail is also a very simple need. I’ve wrote serveral scripts for sending mail because I could not find the scripts I made before. This time I wanna get the things done - made is open on Github with GPLv3.</p>
<h1 id="Code">Code</h1><p>Project address is here: <a href="https://github.com/baniuyao/python-sendmail%20A" target="_blank" rel="external">python-sendmail on Github</a>.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This program is free software; you can redistribute it and/or modify</span></span><br><span class="line"><span class="comment"># it under the terms of the GNU General Public License as published by</span></span><br><span class="line"><span class="comment"># the Free Software Foundation; either version 3 of the License, or</span></span><br><span class="line"><span class="comment"># (at your option) any later version.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> smtplib, sys</span><br><span class="line"><span class="keyword">from</span> email.MIMEText <span class="keyword">import</span> MIMEText</span><br><span class="line"></span><br><span class="line"><span class="comment"># you can change this constant to parameters of sendmail</span></span><br><span class="line">USR_FROM = <span class="string">'me@yaorenjie.com'</span></span><br><span class="line">USR = <span class="string">'me'</span></span><br><span class="line">PASSWD = <span class="string">'HELLO_WORLD'</span></span><br><span class="line"></span><br><span class="line">SMTP_SERVER = <span class="string">'email.yaorenjie.com'</span></span><br><span class="line">SMTP_PORT = <span class="number">587</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sendmail</span><span class="params">(usr_to, subject, msg, subtype=<span class="string">'html'</span>)</span>:</span></span><br><span class="line">    usr_from = USR_FROM</span><br><span class="line">    msg = MIMEText(msg, subtype, _charset=<span class="string">'utf-8'</span>)</span><br><span class="line">    msg[<span class="string">'Subject'</span>] = subject</span><br><span class="line">    msg[<span class="string">'To'</span>] = <span class="string">';'</span>.join(usr_to)</span><br><span class="line">    msg[<span class="string">'From'</span>] = usr_from</span><br><span class="line">    server = smtplib.SMTP()</span><br><span class="line">    server.connect(SMTP_SERVER, SMTP_PORT)</span><br><span class="line">    <span class="comment"># ONLY for debug</span></span><br><span class="line">    <span class="comment"># server.set_debuglevel(1)</span></span><br><span class="line">    <span class="comment"># if exchange use STARTTLS auth, you need to uncomment next line</span></span><br><span class="line">    <span class="comment"># server.starttls()</span></span><br><span class="line">    server.login(USR, PASSWD)</span><br><span class="line">    server.sendmail(usr_from, usr_to, msg.as_string())</span><br><span class="line">    server.quit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="string">"""</span><br><span class="line">    Example:</span><br><span class="line">    python sendmail.py --usr_to mike@mail.com peter@mail.com --subject 'TEST_SUBJECT' --msg 'TEST_MSG'</span><br><span class="line"></span><br><span class="line">    Remark:</span><br><span class="line">    1. msg supports HTML and Chinese</span><br><span class="line">    """</span></span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">'parser for senemail'</span>)</span><br><span class="line">    parser.add_argument(<span class="string">'--usr_to'</span>, dest=<span class="string">'usr_to'</span>, nargs=<span class="string">'+'</span>, required=<span class="keyword">True</span>)</span><br><span class="line">    parser.add_argument(<span class="string">'--subject'</span>, dest=<span class="string">'subject'</span>, required=<span class="keyword">True</span>)</span><br><span class="line">    parser.add_argument(<span class="string">'--msg'</span>, dest=<span class="string">'msg'</span>, required=<span class="keyword">True</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    sendmail(usr_to=args.usr_to, subject=args.subject, msg=args.msg)</span><br></pre></td></tr></table></figure></p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">&raquo;</a>
  </nav>

 </div>

        

        
      </div>

      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      <section class="site-overview">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/images/avatar-hippo.jpg" alt="Renjie Yao" itemprop="image"/>
          <p class="site-author-name" itemprop="name">Renjie Yao</p>
        </div>
        <p class="site-description motion-element" itemprop="description"></p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">17</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">0</span>
              <span class="site-state-item-name">categories</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">33</span>
              <span class="site-state-item-name">tags</span>
              </a>
          </div>

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="menu-item-icon icon-next-feed"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/baniuyao" target="_blank">github</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/frankymryao" target="_blank">weibo</a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner"> <div class="copyright" >
  
  &copy; &nbsp; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="icon-next-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Renjie Yao</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT
  </a>
</div>


 </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  
  
    
    

  

    <script type="text/javascript">
      var disqus_shortname = 'renjieyaoblog';
      var disqus_identifier = 'index.html';
      var disqus_title = '';
      var disqus_url = '';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
    </script>
  


  
  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.1"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.1"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.5.1" id="motion.global"></script>




  <script type="text/javascript" src="/js/nav-toggle.js?v=0.4.5.1"></script>
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  

  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
      if (isMobile()) {
        FastClick.attach(document.body);
      }
    });
  </script>

  

  
  

  
  <script type="text/javascript" src="/js/lazyload.js"></script>
  <script type="text/javascript">
    $(function () {
      $("#posts").find('img').lazyload({
        placeholder: "/images/loading.gif",
        effect: "fadeIn"
      });
    });
  </script>
</body>
</html>
